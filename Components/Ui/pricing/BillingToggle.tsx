"use client";

import { useState } from "react";

type BillingToggleProps = {
  billingType?: "monthly" | "yearly";
  onBillingTypeChange?: (type: "monthly" | "yearly") => void;
};

export default function BillingToggle({ billingType: controlledBilling, onBillingTypeChange }: BillingToggleProps) {
  const [internalBilling, setInternalBilling] = useState<"monthly" | "yearly">("yearly");
  const billingType = controlledBilling ?? internalBilling;
  const setBillingType = onBillingTypeChange ?? setInternalBilling;

  return (
    <div className="relative inline-flex items-center space-x-2 bg-[#F9FAFB] border border-[#F2F4F7] rounded-lg p-1">
      {/* Discount Tag */}
      <div className="absolute -top-12 left-0 -rotate-12 flex flex-col items-center">
        <div className="bg-primary text-white text-xs font-semibold px-4 py-2 rounded-full">
          20% OFF
        </div>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="10"
          height="16"
          viewBox="0 0 10 16"
          fill="none"
        >
          <path
            d="M9.07934 15.1732C9.09433 15.4489 8.88295 15.6846 8.60721 15.6996L4.11384 15.9438C3.83811 15.9588 3.60243 15.7474 3.58745 15.4717C3.57246 15.1959 3.78384 14.9602 4.05958 14.9453L8.05368 14.7282L7.83661 10.7341C7.82162 10.4583 8.033 10.2227 8.30874 10.2077C8.58447 10.1927 8.82015 10.4041 8.83513 10.6798L9.07934 15.1732ZM3.31292 8.99608L3.75677 8.76587L3.31292 8.99608ZM8.58008 15.2003C8.24623 15.5725 8.24618 15.5725 8.24611 15.5724C8.24607 15.5724 8.24599 15.5723 8.2459 15.5722C8.24573 15.5721 8.24551 15.5719 8.24522 15.5716C8.24465 15.5711 8.24385 15.5704 8.24282 15.5695C8.24076 15.5676 8.23779 15.5649 8.23393 15.5614C8.2262 15.5545 8.21491 15.5443 8.20025 15.5309C8.17093 15.5043 8.12813 15.4651 8.07335 15.4145C7.96382 15.3133 7.80634 15.1662 7.61315 14.9812C7.22697 14.6115 6.69695 14.0893 6.12116 13.4792C4.97939 12.2694 3.62095 10.6759 2.86907 9.22629L3.31292 8.99608L3.75677 8.76587C4.44033 10.0838 5.71547 11.5924 6.84842 12.7928C7.40999 13.3879 7.92762 13.8979 8.30474 14.2589C8.4932 14.4394 8.64629 14.5824 8.75191 14.68C8.80471 14.7287 8.84563 14.7661 8.87314 14.7912C8.8869 14.8037 8.8973 14.8131 8.90416 14.8193C8.90759 14.8224 8.91013 14.8247 8.91177 14.8262C8.91259 14.8269 8.91318 14.8274 8.91354 14.8278C8.91372 14.8279 8.91384 14.828 8.9139 14.8281C8.91394 14.8281 8.91394 14.8281 8.91396 14.8281C8.91395 14.8281 8.91392 14.8281 8.58008 15.2003ZM3.31292 8.99608L2.86907 9.22629C2.01339 7.57652 1.50683 5.30284 1.21259 3.481C1.06424 2.56248 0.967693 1.74425 0.908194 1.15543C0.878427 0.860857 0.857889 0.623267 0.844757 0.458743C0.83819 0.376472 0.833472 0.312439 0.830375 0.268655C0.828827 0.246761 0.827684 0.229928 0.826918 0.218405C0.826535 0.212643 0.826246 0.208208 0.826048 0.205133C0.825949 0.203595 0.825872 0.202396 0.825818 0.201542C0.82579 0.201114 0.825769 0.200773 0.825754 0.200517C0.825745 0.20039 0.825738 0.200264 0.825733 0.2002C0.825726 0.200094 0.825722 0.200012 1.32475 0.168856C1.82378 0.1377 1.82378 0.13766 1.82377 0.137642C1.82378 0.137664 1.82378 0.137667 1.82378 0.137713C1.82378 0.137803 1.8238 0.13798 1.82381 0.138241C1.82385 0.138765 1.8239 0.13963 1.82398 0.140833C1.82413 0.143239 1.82438 0.146996 1.82472 0.152072C1.82539 0.162225 1.82644 0.177656 1.82788 0.198114C1.83078 0.239033 1.83527 0.300052 1.84159 0.379173C1.85422 0.537437 1.87414 0.768001 1.90313 1.0549C1.96114 1.62902 2.05532 2.42701 2.1998 3.32156C2.49121 5.12588 2.97874 7.26581 3.75677 8.76587L3.31292 8.99608Z"
            fill="#4919DD"
          />
        </svg>
      </div>

      {/* Yearly Button */}
      <button
        className={`px-4 py-2 rounded-lg text-sm font-bold transition ${
          billingType === "yearly"
            ? "bg-white text-gray-900 shadow"
            : "text-gray-500"
        }`}
        onClick={() => setBillingType("yearly")}
      >
        Yearly
      </button>

      {/* Monthly Button */}
      <button
        className={`px-4 py-2 rounded-lg text-sm font-bold transition ${
          billingType === "monthly"
            ? "bg-white text-gray-900 shadow"
            : "text-gray-500"
        }`}
        onClick={() => setBillingType("monthly")}
      >
        Monthly
      </button>
    </div>
  );
}
